# 实验背景

同事需求：进一步、深入掌握Agent技术路线

# 实验目的

通过调试TS代码，深入掌握Agent技术路线

# 实验步骤

## 在win11上搭建调试环境

1. 安装 bun

```powershell
powershell -c "irm bun.sh/install.ps1 | iex"
```

2. 下载代码

https://github.com/browseros-ai/BrowserOS-agent

代码位于：C:\Users\admin\Documents\GitHub\一所\20251216GUIAgent\code\BrowserOS-agent-main

3. 安装依赖

```powershell
cd C:\Users\admin\Documents\GitHub\一所\20251216GUIAgent\code\BrowserOS-agent-main
bun install  // 共安装3233个依赖包，用时250秒
cp .env.example .env.development
```

4. 进行调试

```powershell
cd C:\Users\admin\Documents\GitHub\一所\20251216GUIAgent\code\BrowserOS-agent-main
bun run start:server          # Start the server
cd C:\Users\admin\Documents\GitHub\一所\20251216GUIAgent\code\BrowserOS-agent-main
bun run start:agent           # Start agent extension (dev mode)
```

我看到 --user-data-dir=/tmp/browseros-dev 难道只能在ubuntu上？

## 在ubuntu上搭建运行环境

1. 安装 bun（国内网络加速）

```bash
curl -fsSL https://cdn.bytedance.net/npm/bun/install.sh | bash
```

2. 下载代码

https://github.com/browseros-ai/BrowserOS-agent

代码位于：/home/zhbli/projects/20251216GUIAgent/code/BrowserOS-agent-main

3. 安装依赖（国内网络加速）

```bash
cd /home/zhbli/projects/20251216GUIAgent/code/BrowserOS-agent-main
bun install --registry=https://registry.npmmirror.com  # 3241 packages installed [24.36s]
cp .env.example .env.development
```

4. 进行调试

```bash
cd /home/zhbli/projects/20251216GUIAgent/code/BrowserOS-agent-main
bun run start:server          # Start the server
cd /home/zhbli/projects/20251216GUIAgent/code/BrowserOS-agent-main
bun run start:agent           # Start agent extension (dev mode)
```

失败。但是我昨天成功过。

## 用昨天的方法跑通debug环境搭建

1. 进入项目根目录，执行

```bash
yarn install
npm run dev
```

2. 打开 Chrome 浏览器，进入 chrome://extensions/。

开启右上角 “开发者模式” (Developer mode)。

点击 “加载已解压的扩展程序” (Load unpacked)。

选择项目里的 dist (或 build) 文件夹。

3. 去 chrome://extensions/ 页面。

点击插件下方的 “Service Worker”（后台脚本）链接。

在弹出的新控制台里，你会发现另一套文件树，那里通常包含核心的 Agent 逻辑文件。

老版本能这么用。新版本不行：

```bash
(base) zhbli@zhbli-91C6A09QKX:~/下载/BrowserOS-agent-main(1)2/BrowserOS-agent-ma
in$ yarn install
yarn install v1.22.22
info No lockfile found.
[1/5] Validating package.json...
warning browseros-monorepo@1.0.0: The engine "bun" appears to be invalid.
error browseros-monorepo@1.0.0: The engine "node" is incompatible with this module. Expected version "please-use-bun". Got "25.2.1"
error browseros-monorepo@1.0.0: The engine "yarn" is incompatible with this module. Expected version "please-use-bun". Got "1.22.22"
warning browseros-monorepo@1.0.0: The engine "pnpm" appears to be invalid.
error Found incompatible module.
info Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.
```

4. 想要跑通，需要配置本地大模型：
api_key = 'sk-efe1c9004f7e4de0a8ade26120301c6d'
base_url = 'https://dashscope.aliyuncs.com/compatible-mode/v1'
model = 'qwen-vl-max'

## 记录调用过程

- getBrowserStateMessage: 完成

## 原生工具调用大模型

- qwen？

https://effish.ai/blog/qwen-tool-calling

主流的实现方式主要有两种：

方式一：Prompt工程 通过精心设计的提示词，引导模型在需要时输出特定格式的工具调用指令。

方式二：模型微调 对模型进行专门的工具调用训练，使其原生支持工具调用能力。Qwen系列模型采用这种方式。

qwen-plus 既能支持视觉，又支持工具调用。