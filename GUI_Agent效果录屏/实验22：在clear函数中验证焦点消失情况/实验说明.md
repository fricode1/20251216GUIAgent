# 实验背景

之前明明在实验20中很确定是clear函数的js代码导致了焦点消失，但是在实验21中有了矛盾的结论。所以需要进一步在clear函数内部确认焦点消失情况。

# 实验目标

在clear函数内部验证焦点消失情况

# 实验步骤

## 确认 prompt

task = '在12306.cn 点击 出发日期 列表，输入 2025-12-31'

## 找出 _clear_text_field 函数代码

在第1049行

## 在函数开始处添加查看焦点的代码

```python
result = await cdp_session.cdp_client.send.Runtime.evaluate({
    "expression": """
        (function() {
            const focused = document.activeElement;
            if (!focused) return null;
            // 返回焦点元素的标签名、ID 和类名
            return {
                tagName: focused.tagName,
                id: focused.id,
                className: focused.className,
                outerHTML: focused.outerHTML.substring(0, 100)  // 截取部分 HTML
            };
        })()
    """,
    "returnByValue": True
}, session_id=cdp_session.session_id)

if result["result"]["value"]:
    focused_info = result["result"]["value"]
    print("当前焦点元素信息：")
    print(f"标签名: {focused_info['tagName']}")
    print(f"ID: {focused_info['id']}")
    print(f"类名: {focused_info['className']}")
    print(f"HTML 片段: {focused_info['outerHTML']}")
else:
    print("当前无焦点元素")
```

执行结果：有焦点

## 在执行完js之后再执行查看焦点的代码

执行结果：无焦点

这支持了实验20的观察，反驳了实验21的观察。

# 实验结果

就是js代码导致的。但怎么解释实验21呢？需要通过cdp_use复现这一现象。

# 未来计划

通过 cdp_use 复现焦点消失现象