# 实验背景

寻找了一整天的容器浏览器终于找到了（实验80），现在要用起来

# 实验目的

制作容器浏览器

# 实验步骤

## 拷贝代码

成功。

## 问大模型如何制作镜像

我通过 docker-compose.yml 运行的容器很好，但是该容器缺少了 requirements.txt 中的pip包，以及 node 环境。我该怎么办？

## 将核心代码复制过来

cd frontend
npm install

## 构建镜像

docker build --pull=false -t auto-web:v2.0 .

## 难点：好像Alpine不支持onnxruntime

lscr.io/linuxserver/webtop 能够在容器中使用浏览器。但是Alpine不支持onnxruntime

## 【成功】使用新的基础镜像

lscr.io/linuxserver/webtop:ubuntu-xfce

进入内部验证是否能用 DrissionPage

sudo docker run -it lscr.io/linuxserver/webtop:ubuntu-xfce /bin/bash

不行。

换成 docker-compose.yml 启动

成功。经验：必须从yml启动。

## 构建镜像

sudo docker build --pull=false -t auto-web:v2.0 .

## 【成功】运行 yml

sudo docker compose up

http://localhost:3000/ 看实时界面

sudo docker ps 看 container id

sudo docker exec -it a7c /bin/bash

测试DrissionPage

```python
from DrissionPage import Chromium
tab = Chromium().latest_tab
tab.get('https://www.baidu.com')
```

清理容器

sudo docker stop $(sudo docker ps -aq)
sudo docker rm $(sudo docker ps -aq)

## 运行代码

### 运行 minio

./minio server /minio-data --console-address ":9001"

### 运行后端

python backend/main.py

### 运行前端

cd frontend
npm run dev

## 打包镜像

sudo docker save -o /tmp/auto-web:v2.0.tar auto-web:v2.0