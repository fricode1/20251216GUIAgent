# 实验背景

云端部署是 browser use 的一项重要功能，也是同事提出的一项需求。因此需要看看能否实现云端部署。

云端部署的好处：假如局域网有10台电脑，希望这10台电脑都有 browser use 功能。一种方式是每台电脑都安装 browser use，另一种方式是服务器安装 browser use，客户端安装什么呢？

我还是不太清楚这么做的意义是什么。但为什么同事提出这项需求，且 browser use 将其作为一项重要功能呢？看来我需要弄懂云端部署的意义。

# 实验目的

弄懂云端部署的意义 + 跑通云端部署。

# 实验步骤

## 让豆包理解源码，回答我的疑惑

通过对话，我好像混淆了一件事情：云端模式和headless模式。所谓headless模式是指不弹出实体浏览器窗口即可执行web自动化操作。同事提需求明确说的是“后台部署”。

我需要明确同事的需求。

在明确之前，我是不是得把这两种模式都熟悉一下？

`browser-use` 框架的 `Browser` 类支持直接通过 `cdp_url` 参数连接任何遵循 CDP 协议的浏览器实例，包括你自己搭建的云端浏览器。

云端部署的意义：加入你的web应用非常非常庞大，在国产机器上很卡，那么云端部署是有意义的。

## 同时实现云浏览器和headless

**1. 在自建云服务器上部署浏览器**

在你的云服务器（如 AWS、GCP、阿里云等）上安装 Chrome/Chromium，并启动带有 CDP 接口的浏览器进程，例如：

```bash
# 在云服务器上启动浏览器，开放 CDP 端口（9222）
# sudo apt install -y chromium-browser 
chromium --remote-debugging-port=9222 --remote-debugging-address=0.0.0.0 --headless=new
```

启动后，服务器会生成一个 CDP 连接 URL（如 `http://<你的云服务器IP>:9222`）。

**2. 在 `browser-use` 中连接自建云浏览器**

在代码中通过 `cdp_url` 指定自建浏览器的 CDP 地址即可：

```python
import asyncio

from browser_use import Agent, Browser, ChatOpenAI, ChatBrowserUse
llm = ChatBrowserUse(api_key='bu_eWRuVFK-tQu2KV_6JugfZ4vyD2a8qK-UslRhpiIUK5Q')

# Connect to your existing Chrome browser
browser = Browser(
	cdp_url="http://127.0.0.1:9222" # 替换为实际的 CDP 地址
)

agent = Agent(
	task='Visit https://www.zhihu.com 总结你看到的内容',
	browser=browser,
	llm=llm,
)

async def main():
	await agent.run()

if __name__ == "__main__":
	asyncio.run(main())
```

# 实验结果

见视频。成功完成了任务。