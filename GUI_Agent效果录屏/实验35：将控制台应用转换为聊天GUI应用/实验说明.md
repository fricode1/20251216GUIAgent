# 实验背景

我之前的思路是采用JS原生AI浏览器。这样非常纯粹，没有中转（不论代码层面还是交互层面）。然而：
- JS开发不熟悉
- 现有成果无用了
- 想要利用JS技术路线重现目前获得的成果很难（本地模型视频、效果好坏）
- 现有JS效果也不咋地
- 将来扩展难（很多AI项目都是python的）

我突发奇想，为何不将控制台应用转换为聊天GUI应用（python实现）呢？能解决上述全部问题。具有如下优势：
- 这样实现起来最快
- 目前代码已经在真实系统上跑起来了，要是换方案就得重新开始。
- 如果同事需求是，尽快在真实系统展示产品，套壳python应用是最快的

# 实验目的

将控制台应用转换为聊天GUI应用（python实现）

# 实验步骤

## 明确被套壳的python代码

实验27代码是需要被套壳的代码。

## 让AI生成套壳代码

请你生成一个新的python代码，将上述控制台应用转换为聊天GUI应用（python实现）

运行：

```bash
conda activate browser_use_py312

cd GUI_Agent效果录屏/实验35：将控制台应用转换为聊天GUI应用
python browser_use_app.py
```

### 尝试1：使用 CustomTkinter 失败

```
pip install customtkinter
```

Linux 环境下 Tkinter（CustomTkinter 的底层）最臭名昭著的问题：X11 字体渲染 Bug。

在很多 Linux 发行版（尤其是 Ubuntu/Debian 变体）中，Tkinter 的字体渲染会出现“重影”、“双重绘制”或“点阵化严重”的问题，这是因为底层的 Freetype 渲染引擎和 X11 窗口合成器之间的兼容性导致的。

## 尝试2：使用 Pyside6

```
pip install PySide6 -i https://mirrors.aliyun.com/pypi/simple/
```

运行代码时候报错：

```
qt.qpa.plugin: From 6.5.0, xcb-cursor0 or libxcb-cursor0 is needed to load the Qt xcb platform plugin.
qt.qpa.plugin: Could not load the Qt platform plugin "xcb" in "" even though it was found.
This application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.

Available platform plugins are: linuxfb, minimalegl, vnc, wayland-brcm, wayland-egl, wayland, offscreen, eglfs, xcb, vkkhrdisplay, minimal.

已中止 (核心已转储)
```

安装库：

```
sudo apt-get install libxcb-cursor0
```

问题：无法切换中文输入法（我在电脑的其他地方也碰到过这个问题——在自带的文件管理器中视图重命名文件时）。我该纠结这个问题吗？

gemini说：是一个非常典型的 Linux 桌面环境（X11/Wayland）与输入法框架（Fcitx 或 IBus）的兼容性问题。我的建议是：绝对不要纠结，直接无视它。这是你 Linux 系统底层环境（环境变量或输入法插件缺失）的问题，不是 PySide6 的锅，更不是你程序的逻辑问题。修复成本极高。

ok了。

## 实现控制台日志转发到GUI功能

完成

接下来做什么？花一小点实验看看能不能优化窗口排布

## 优化窗口排布

### 确认调用Browser时如何指定屏幕位置

https://docs.browser-use.com/customize/browser/all-parameters

```python
browser = Browser(
    executable_path='/usr/bin/google-chrome',
    user_data_dir=os.path.expanduser('~/.config/google-chrome'),
    profile_directory='Default',
    window_size={'width': 1200, 'height': 800},
    window_position={'width': 100, 'height': 0},  # 左上角为0，0
)
```

应该设置成：

```python
app_width = 500
browser = Browser(
    executable_path='/usr/bin/google-chrome',
    user_data_dir=os.path.expanduser('~/.config/google-chrome'),
    profile_directory='Default',
    window_size={'width': 1920-app_width, 'height': 1080},
    window_position={'width': app_width, 'height': 0},  # 左上角为0，0
)
```

中止

# 实验结果

经及时与同事讨论，得知这种方式的缺陷很多：
- 安装python环境（且需要高版本py310+、QT）或electron，配置浏览器路径。

所以纯浏览器 + 后台才是可行方案

我需要将这一点做成一页PPT说明一下

# 未来工作

做一页PPT 说明基于python的不可行性。