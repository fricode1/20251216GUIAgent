services:
  webtop2:
    image: auto-web:v2.0
    container_name: webtop-nginx-chromium
    security_opt:
      - seccomp=unconfined
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
    ports:
      - "3000:3000"
      - "3001:3001"
      - "9222:9227"
    volumes:
      - /path/to/data:/config
      - ./nginx.conf:/etc/nginx/nginx2.conf
    shm_size: 1gb
    command: >
      sh -c "
        # 启动原始初始化进程
        /init &
        # 等待服务完全启动
        sleep 20
        # 启动自定义服务
        export DISPLAY=:1
        chromium --remote-debugging-port=9222 --no-sandbox --no-first-run --disable-gpu --user-data-dir=/tmp/chrome &
        nginx -c /etc/nginx/nginx2.conf &
        echo 'Custom services started'
        # 保持容器运行
        wait
      "